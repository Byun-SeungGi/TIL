## 쿠키와 세션

# 쿠키와 세션이 필요한 이유
우리가 사용하는 인터넷 프로토콜(HTTP)는 기본적으로 상태가 없다. (Stateless)

이 말의 의미는 클라이언트(브라우저)가 서버에 요청을 보내고 응답을 받으면, 연결이 끊어지게 된다.
서버는 방금 요청했던 클라이언트가 누구인지 기억을 할 수가 없다.

만약 세션과 쿠키가 없다면, 페이지를 이동할 때 마다 로그인을 새로해야하거나, 쇼핑몰에서 상품을 클릭할 때마다 장바구니가 비어져버리는 현상이 발생하게 된다.

이 문제를 해결하기 위해 기억을 유지하는 장치가 필요하고, 그것이 바로 쿠키와 세션이다.

# 쿠키

쿠키는 클라이언트에 저장되는 작은 텍스트 파일이다.

- 쿠키의 원리
1. 서버가 응답헤더에 이 정보를 기억해두라고 실어 보낸다.
2. 브라우저는 그 정보를 저장한다.
3. 이후 서버에 요청을 보낼때마다 브라우저가 알아서 쿠키를 함께 들고 간다.

- 쿠키의 특징
1. 사용자의 컴퓨터(브라우저)에 저장된다.
2. 보안에 취약하다.

쿠키는 보통 오늘 하루 이 창을 보지 않음, 아이디 저장, 최근 본 상품 등 중요하지 않은 편의성 데이터 저장에 사용된다.

# 세션

세션은 서버쪽에 정보를 저장하는 방식이고 보안이 훨씬 강력하다.

- 세션의 원리
1. 중요한 정보(로그인 정보 등)는 서버의 메모리나 DB에 저장한다.
2. 사용자에게는 이 정보에 접근할 수 있는 Session ID를 준다.
3. 서버에 요청을 보낼 때 브라우저는 Session ID를 요청헤더에 자동으로 담아서 보낸다.
4. 서버는 받은 Session ID와 일치하는 서버 메모리 공간을 찾고, 그 메모리 공간안에 저장 해 둔 사용자 정보를 꺼내서 사용한다.

- 세션의 특징
1. 서버자원을 사용한다. (사용자가 많아지면 서버 메모리가 부족해질 수 있다.)
2. 브라우저가 종료되면 보통 삭제된다.

세션은 로그인정보, 사용자권한, 장바구니 내역 등 중요한 정보 관리에 쓰인다.

# 쿠키와 세션

쿠키과 세션은 서로 협력한다.
어떤 협력을 하는지 아래 과정을 통해 보겠다.

1. 클라이언트 : 아이디/비밀번호를 입력후 로그인을 요청한다.
2. 서버 : 회원이 맞는지 확인하고 서버메모리(세션저장소)에 회원정보를 저장한다.
   -> 이 때 각 세션마다 고유한 ID인 Session ID를 생성한다.
3. 서버 -> 클라이언트 : 응답을 보낼 때, 쿠키에 Session ID를 담아서 보낸다.
4. 클라이언트 : 브라우저는 쿠키에 받은 Session ID를 저장한다.
5. 재요청 : 사용자가 '마이페이지'를 클릭하면, 브라우저는 쿠키에 있는 Session ID를 서버로 같이 보낸다.
6. 서버 : 받은 Session ID로 서버 메모리를 확인하여, 아까 로그인한 유저라고 인식 후 페이지를 보여주게 된다.

쉽게 말해 중요한 정보(세션)은 서버에 저장하고, 그 정보를 찾을 수 있는 열쇠(Session ID)만 쿠키에 담아서 사용자가 들고 다니게 하는 것이다.

